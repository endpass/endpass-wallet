<template>
  <v-input :type="inputType" autocomplete="current-password" v-bind="$attrs"
    :value="value"
    @input="$emit('input', $event)"
    @blur="$emit('blur', $event)">
    <a slot="icon" @click="toggleVisible">
      <span class="icon is-small is-right" v-html="require('@/img/eye.svg')">
      </span>
    </a>
  </v-input>
</template>

<script>
import VInput from '@/components/ui/form/VInput.vue';

// Wrap a VInput component to turn it into a toggleable password input
export default {
  name: 'VPassword',
  props: {
    value: {
      type: String,
      default: null,
    },
    // If true, the password is shown to the user
    visible: {
      type: Boolean,
      default: false,
    },
  },
  inject: {
    $validator: '$validator',
  },
  data() {
    return {
      isVisible: this.visible,
    };
  },
  methods: {
    toggleVisible() {
      this.isVisible = !this.isVisible;
    },
  },
  computed: {
    inputType() {
      return this.isVisible ? 'text' : 'password';
    },
  },
  components: {
    VInput,
  },
};
</script>

<style lang="scss">
.control {
  &.has-icons-left,
  &.has-icons-right {
    .icon {
      pointer-events: initial;
    }
  }
}
</style>
